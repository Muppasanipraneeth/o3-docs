# Siderail and Bottom nav

The Siderail and Bottom nav are desktop and tablet versions of the same navigation functionality. They contain a series of links that take users to different tabs in the Workspace. Once open, the Workspace is persistent across pages (for example, all pages within a Patient Chart).

The various styles for different nav button states can be found at https://zeroheight.com/23a080e38/p/948cf1-siderail-and-bottom-nav/b/86907e

## Adding a new nav button

The siderail/ bottom nav buttons can be added to the patient chart simply via extensions.

```json copy
// routes.json
{
  "extensions": [
    {
      "name": "order-basket-action-menu",
      "component": "orderBasketActionMenu",
      "slot": "action-menu-chart-items-slot",
      "order": 0
    }
  ]
}
```

```ts copy
// index.ts
  name: 'order-basket',
  title: 'Order Basket',
  load: getAsyncLifecycle(() => import('./order-basket/order-basket.workspace'), options),
  type: 'order',
  canHide: true,
});

export const orderBasketActionMenu = getAsyncLifecycle(
  () => import('./order-basket-action-button/order-basket-action-button.extension'),
  options,
);
```

```ts copy
// order-basket-action-button.extension.tsx
import React from "react";
import { useTranslation } from "react-i18next";
import { Tag } from "@carbon/react";
import { ShoppingCart } from "@carbon/react/icons";
import {
  useLaunchWorkspaceRequiringVisit,
  useOrderBasket,
  SiderailNavButton,
} from "@openmrs/esm-patient-common-lib";
import styles from "./order-basket-action-button.scss";

const OrderBasketActionButton: React.FC = () => {
  const { t } = useTranslation();
  const { orders } = useOrderBasket();
  const launchOrderBasket = useLaunchWorkspaceRequiringVisit("order-basket");

  return (
    <SiderailNavButton
      name={"order-basket-action-menu"}
      getIcon={(props) => <ShoppingCart {...props} />}
      label={t("orderBasket", "Order basket")}
      iconDescription={t("medications", "Medications")}
      handler={launchOrderBasket}
      type={"order"}
      tagContent={orders?.length > 0 ? orders?.length : null}
    />
  );
};

export default OrderBasketActionButton;
```

## Implementation

The siderail and bottom nav are implemented as a single component, with the siderail and bottom nav being rendered conditionally based on the screen layout (desktop/ layout).

If the workspace with the type passed into the `SiderailNavButton` is already open, the button's active/ interrupted state is set as per the following conditions:

```ts copy
const SiderailNavButton = ({type}) => {
  const { workspaces, workspaceWindowState } = useWorkspaces();
  const workspaceIndex = workspaces?.findIndex(({ type: workspaceType }) => workspaceType === type) ?? -1;
  const isWorkspaceActive = workspaceWindowState !== 'hidden' && workspaceIndex === 0;
  const formOpenInTheBackground = workspaceIndex > 0 || (workspaceIndex === 0 && workspaceWindowState === 'hidden');

  return ...
}
```
