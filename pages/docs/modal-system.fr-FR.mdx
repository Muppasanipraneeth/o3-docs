import { Callout } from "nextra-theme-docs";

# Le système de modal

Une façon plus facile de déclencher une modal sans avoir à utiliser un état conditionnel pour la rendre dans le DOM.

Cela est géré par la fonction [`showModal`](https://o3-docs.openmrs.org/docs/framework-api-reference#showmodal) définie dans `esm-core` qui se charge du rendu de la modal.

<Callout emoji="ℹ️" type="info">
  Pour plus d'informations sur le fonctionnement de `showModal`, consultez son [implémentation](https://github.com/openmrs/openmrs-esm-core/blob/01c32c2090a47a881d5f9fa39650ec4a9037aa36/packages/framework/esm-styleguide/src/modals/index.tsx).
  La référence de l'API peut être trouvée [ici](/docs/framework-api-reference#showmodal).
</Callout>

## Utilisation

### Implémentation de la modal
Créez un composant séparé pour la modal, comme vous le feriez normalement, mais au lieu que le composant le plus haut soit le `ComposedModal`, il devrait être un `React.Fragment`.
Ainsi, dans l'ensemble, la structure de votre modal devrait ressembler à quelque chose comme ceci :

```tsx
const ModalComponent = ({ onClose, props }) => {
    return (
        <React.Fragment>
            <ModalHeader closeModal={onClose} >
                {le contenu de l'en-tête va ici}
            </ModalHeader>
            <ModalBody>
                {le corps de la modal va ici}
            </ModalBody>
            <ModalFooter>
                {le pied de la modal va ici}
            </ModalFooter>
        </React.Fragment>
    )
}
```

<Callout>
Omettre d'envelopper votre modal dans un Fragment React pourrait entraîner un mauvais défilement vertical du corps de la modal.
</Callout>

### Enregistrement de la modal
Vous devez enregistrer la modal par nom dans la propriété `modals` dans le fichier `routes.json` et elle doit être nommée comme une exportation dans le fichier `index.ts` de l'application qui définit la modal.

```json filename="routes.json"
"modals": [
    {
      "name": "votre-nom-de-modal",
      "component": "nomDuComposantModal"
    }
]
```

```ts filename="index.ts"
import { getAsyncLifecycle } from '@openmrs/esm-framework';

export const nomDuComposantModal = getAsyncLifecycle(
  () => import('/chemin-vers-le-composant-modal/modal-component.tsx'),
  options,
);
```

### Déclenchement de la modal
Enfin, vous pouvez déclencher votre modal en appelant `showModal` ainsi que toutes les propriétés que vous devez passer à la modal. Dans l'exemple ci-dessous, nous avons passé `onClose` comme une propriété au composant de modal.
La fonction dispose qui est renvoyée par `showModal` peut être appelée pour "disposer" ou fermer de force la modal.

```ts 
const dispose = showModal('votre-nom-de-modal', {
    onClose: () => dispose(),
    // les propriétés à passer au composant de modal
});
```
