import { Callout } from "nextra-theme-docs";

# Le système de modal

Le système modal fait partie du framework qui gère le rendu des boîtes de dialogue modales, des avertissements et d'autres affichages similaires. Son objectif principal est de coordonner les modaux entre différentes applications afin qu'un seul modal soit rendu à l'utilisateur à la fois sans qu'aucun autre modal ne soit supprimé.

Pour utiliser le système modal, votre application doit d'abord enregistrer le modal, comme décrit ci-dessous. Une fois le modal enregistré, appelez [`showModal`](https://o3-docs.openmrs.org/docs/framework-api-reference#showmodal) avec le nom du modal et le framework affichera le modal pour vous.

## Utilisation

### Implémentation de la modal
Les `ModalHeader` et `ModalBody` doivent être au niveau supérieur du composant modal et enveloppés dans un `React.Fragment`.

```tsx
const ModalComponent = ({ onClose, props }) => {
    return (
        <React.Fragment>
            <ModalHeader closeModal={onClose} >
                {le contenu de l'en-tête va ici}
            </ModalHeader>
            <ModalBody>
                {le corps de la modal va ici}
            </ModalBody>
            <ModalFooter>
                {le pied de la modal va ici}
            </ModalFooter>
        </React.Fragment>
    )
}
```

<Callout>
Omettre d'envelopper votre modal dans un Fragment React pourrait entraîner un mauvais défilement vertical du corps de la modal.
</Callout>

### Enregistrement de la modal
Vous devez enregistrer la modal par nom dans la propriété `modals` dans le fichier `routes.json` et elle doit être nommée comme une exportation dans le fichier `index.ts` de l'application qui définit la modal.

```json filename="routes.json"
"modals": [
    {
      "name": "votre-nom-de-modal",
      "component": "nomDuComposantModal"
    }
]
```

```ts filename="index.ts"
import { getAsyncLifecycle } from '@openmrs/esm-framework';

export const nomDuComposantModal = getAsyncLifecycle(
  () => import('/chemin-vers-le-composant-modal/modal-component.tsx'),
  options,
);
```

### Déclenchement de la modal
Enfin, vous pouvez déclencher votre modal en appelant `showModal` ainsi que toutes les propriétés que vous devez passer à la modal. Dans l'exemple ci-dessous, nous avons passé `onClose` comme une propriété au composant de modal.
La fonction dispose qui est renvoyée par `showModal` peut être appelée pour "disposer" ou fermer de force la modal.

```ts 
const dispose = showModal('votre-nom-de-modal', {
    onClose: () => dispose(),
    // les propriétés à passer au composant de modal
});
```
